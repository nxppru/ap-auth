/*! jike(www.cnrouter.com) 2015-03-20 */
"use strict";jQuery(function(a){function b(){var b=a("#login_username").val(),d=a("#login_password").val();return""==a.trim(b)||""==a.trim(d)?(a("#alert_box_login").jk_alert({msg:"用户名或密码不能为空",type:"danger",show_time:3500}),!1):(a(this).button("loading"),void a.ajax({url:c+"/Admin/check",data:{username:b,passwd:hex_md5(hex_md5(d))},dataType:"json",type:"POST",success:function(b){a("#submint_login").button("reset"),1==b.ret?(a("#alert_box_login").jk_alert({msg:"登录成功，正在跳转",type:"success",show_time:3500}),a("#frm1").submit()):a("#alert_box_login").jk_alert({msg:b.msg,type:"danger",show_time:3500})}}))}var c=a("#app").val();a("#go_reg").click(function(){a("#login-box").removeClass("visible"),a("#signup-box").addClass("visible")}),a("#back_login").click(function(){a("#signup-box").removeClass("visible"),a("#login-box").addClass("visible")}),a("#submint_login").click(function(){b()}),document.onkeydown=function(a){var c=document.all?window.event:a;13==c.keyCode&&b()},a("#login_username").focus();var d=0;a("#getCode").click(function(){var b=/^(13[0-9]|15[0-9]|18[0-9])\d{8}$/,f=a("#reg_phone").val();return b.test(f)?void a.ajax({url:c+"/Merchant/get_code",data:{phone:f},dataType:"json",type:"POST",success:function(b){1==b.ret?(a("#alert_box_reg").jk_alert({msg:b.msg,type:"success",show_time:3500}),d=60,a("#getCode").attr("disabled",!0),e()):a("#alert_box_reg").jk_alert({msg:b.msg,type:"danger",show_time:3500})}}):(a("#alert_box_reg").jk_alert({msg:"手机号码格式错误",type:"danger",show_time:3500}),!1)});var e=function(){0==d?(a("#getCode").attr("disabled",!1),a("#getCode").text("获取验证码")):(d--,a("#getCode").text(d+"秒之后重新获取"),setTimeout(function(){e()},1e3))};a("#register").click(function(){var d=a("#reg_username").val(),e=a("#reg_password").val(),f=a("#reg_cfpassword").val(),g=a("#reg_phone").val(),h=a("#reg_code").val();if(""==a.trim(d)||d.length<2||d.length>20)return a("#alert_box_reg").jk_alert({msg:"请填写用户名,长度范围为[2-20]",type:"danger",show_time:3500}),!1;if(""==a.trim(e)||e.length<6||e.length>20)return a("#alert_box_reg").jk_alert({msg:"请填写密码,长度范围为[6-20]",type:"danger",show_time:3500}),!1;if(""==a.trim(f)||f.length<6||f.length>20)return a("#alert_box_reg").jk_alert({msg:"请再次填写密码,长度范围为[6-20]",type:"danger",show_time:3500}),!1;var i=/^(13[0-9]|15[0|3|6|7|8|9]|18[0-9])\d{8}$/;if(""==a.trim(g)||!i.test(g))return a("#alert_box_reg").jk_alert({msg:"手机号码格式错误",type:"danger",show_time:3500}),!1;if(""==a.trim(h))return a("#alert_box_reg").jk_alert({msg:"请填写短信验证码",type:"danger",show_time:3500}),!1;var j={username:d,password:hex_md5(hex_md5(e)),cfpassword:hex_md5(hex_md5(f)),phone:g,code:h};a.ajax({url:c+"/Merchant/reg_merchant",data:j,dataType:"json",type:"POST",success:function(c){1==c.ret?(a("#alert_box_reg").jk_alert({msg:c.msg,type:"success",show_time:3500}),a("#login_username").val(d),a("#login_password").val(e),b()):a("#alert_box_reg").jk_alert({msg:c.msg,type:"danger",show_time:3500})}})})});